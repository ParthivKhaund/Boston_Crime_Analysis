---
title: "STAT 184 Final Project Preliminary EDA" 
author: "Abhishek Raj, Sarthak Batra and Parthiv Khaund"
output: html_notebook
---


## Final Project 


## Front Matter
```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(leaflet)
library(ggplot2)
library(ggExtra)

```


#### Loading Data

```{r}
crime_stats <- read.csv("crime.csv")

```


#### Summary Statistics
```{r}
str(crime_stats)
```

```{r}
summary(crime_stats)
```


```{r}
crime_stats
```

```{r}
Test<-
  crime_stats%>%
  select(OFFENSE_CODE_GROUP)%>%
  count(OFFENSE_CODE_GROUP, sort = TRUE)
Test
```

```{r}
Test1<-
  crime_stats%>%
  select(OFFENSE_CODE_GROUP,OFFENSE_DESCRIPTION)%>%
  filter(OFFENSE_CODE_GROUP == "Auto Theft")
Test1
```

```{r}
# top criminal districs 
distric_count<-
  crime_stats %>%
  group_by(DISTRICT)%>%
  summarise(number_of_crimes = n())%>%
  arrange(desc(number_of_crimes))

distric_count <- distric_count[1:12,]

total <- sum(distric_count$number_of_crimes)

pie<-
  distric_count%>%
  mutate(percentage_of_total_crime = (number_of_crimes*100)/total)
pie
  
```

```{r}
ggplot(data = pie ,aes(x= "" , y = percentage_of_total_crime,fill=DISTRICT))+geom_bar(stat = "identity",width=1,color="white")+coord_polar("y", start=0)
```

```{r}
# top 10 criminal latitude longitude 
lat_long_count<-
  crime_stats %>%
  group_by(Lat,Long)%>%
  summarise(counter = n())%>%
  arrange(desc(counter))

lat_long_count <- lat_long_count[-c(9),] 
lat_long_count <- lat_long_count[2:21,]
lat_long_count
```

```{r}
# top 20 criminal areas 
stationMap <-
  leaflet(lat_long_count) %>%   # like ggplot()
  addTiles() %>%          # add the map
  addMarkers()

stationMap
```

#### Describe preliminary observations and intuition about the research question

Based on a preliminary observation from the graph we find that some months have more crime in a reported area.


### TWO Data Sources

#### Primary Data

The primary data that we will use is from https://www.kaggle.com/ankkur13/boston-crime-data 

#### Other data sources

ZipGeography is an another data source that we are planning to use.


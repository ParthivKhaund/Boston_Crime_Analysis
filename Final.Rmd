---
title: "STAT 184 Final Project Preliminary EDA" 
author: "Abhishek Raj, Sarthak Batra and Parthiv Khaund"
output: html_notebook
---


## Final Project 


## Front Matter
```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(mosaic)
library(tidyverse)
library(leaflet)
library(ggplot2)

```


#### Loading Data

```{r}
crime_stats <- read.csv("crime.csv")
Van_crime_stats <- read.csv("Vancouver_crime_data.csv")
```


#### Summary Statistics
```{r}
str(crime_stats)
```

```{r}
summary(crime_stats)
```


```{r}
crime_stats
```


### Data Wrangling

#### Data Cleaning

```{r}
df <- crime_stats
df <- df[, -c(13, 17)] 
df[1:10,]

```

```{r}
df1 <- Van_crime_stats
df1 <- df1[, c(1,3)] 
df1[1:10,]


```

#### Number of offence in Month

```{r}
Month<-
  df%>%
  select(OFFENSE_CODE_GROUP,MONTH)%>%
  count(OFFENSE_CODE_GROUP, MONTH, sort = TRUE)%>%
  select(MONTH,n)
Month

BarTest <- aggregate(Month$n, by=list(MONTH=Month$MONTH), FUN=sum)
BarTest
```

```{r}
Mon<-
  df%>%
  select(OFFENSE_CODE_GROUP,MONTH)%>%
  count(OFFENSE_CODE_GROUP, MONTH, sort = TRUE)%>%
  filter(OFFENSE_CODE_GROUP == "Motor Vehicle Accident Response"|OFFENSE_CODE_GROUP == "Larceny"|OFFENSE_CODE_GROUP == "Medical Assistance	"|OFFENSE_CODE_GROUP == "Investigate Person"|OFFENSE_CODE_GROUP == "Other"|OFFENSE_CODE_GROUP == "Drug Violation"|OFFENSE_CODE_GROUP == "Simple Assault"|OFFENSE_CODE_GROUP == "Vandalism"|OFFENSE_CODE_GROUP == "Verbal Disputes"|OFFENSE_CODE_GROUP == "Towed")
Mon

```

```{r}
ggplot(data=Mon,aes(x=MONTH,y=n ,fill=OFFENSE_CODE_GROUP))+geom_bar(stat='identity',position='stack', width=.9)+scale_fill_brewer(type='div',palette=1) + scale_x_continuous(name = "Months ", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12)) + scale_y_continuous(name = "Number of Crimes " , breaks = c(5000,10000,15000,20000))

```

#### Count of Offence Codes
```{r}
Test<-
  crime_stats%>%
  select(OFFENSE_CODE_GROUP)%>%
  count(OFFENSE_CODE_GROUP, sort = TRUE)
Test
```

```{r}
Test1<-
  crime_stats%>%
  select(OFFENSE_CODE_GROUP,OFFENSE_DESCRIPTION)%>%
  filter(OFFENSE_CODE_GROUP == "Auto Theft")
Test1
```

```{r}
# top criminal districs 
distric_count<-
  crime_stats %>%
  group_by(DISTRICT)%>%
  summarise(number_of_crimes = n())%>%
  arrange(desc(number_of_crimes))

distric_count <- distric_count[1:12,]

total <- sum(distric_count$number_of_crimes)

pie<-
  distric_count%>%
  mutate(percentage_of_total_crime = (number_of_crimes*100)/total)
pie
  
```

```{r}
ggplot(data = pie ,aes(x= "" , y = percentage_of_total_crime,fill=DISTRICT))+geom_bar(stat = "identity",width=1,color="white")+coord_polar("y", start=0)
```

```{r}
# top 10 criminal latitude longitude 
lat_long_count<-
  crime_stats %>%
  group_by(Lat,Long)%>%
  summarise(counter = n())%>%
  arrange(desc(counter))

lat_long_count <- lat_long_count[-c(9),] 
lat_long_count <- lat_long_count[2:21,]
lat_long_count
```

```{r}
# top 20 criminal areas 
stationMap <-
  leaflet(lat_long_count) %>%   # like ggplot()
  addTiles() %>%          # add the map
  addMarkers()

stationMap
```


```{r}
TestVan<-
  df1%>%
  select(TYPE)%>%
  count(TYPE, sort = TRUE)
TestVan[1:10,]

```
```{r}

Month1<-
  df1%>%
  select(TYPE,MONTH)%>%
  count(TYPE, MONTH, sort = TRUE)%>%
  select(MONTH,n)
Month1

BarTest1 <- aggregate(Month1$n, by=list(MONTH=Month1$MONTH), FUN=sum)
BarTest1

```

```{r}
Mon1<-
  df1%>%
  select(TYPE,MONTH)%>%
  count(TYPE, MONTH, sort = TRUE)%>%
  filter(TYPE == "Theft from Vehicle"|TYPE == "Mischief"|TYPE == "Break and Enter Residential/Other"|TYPE == "Offence Against a Person"|TYPE == "Other Theft"|TYPE == "Theft of Vehicle"|TYPE == "Break and Enter Commercial"|TYPE == "Theft of Bicycle"|TYPE == "Vehicle Collision or Pedestrian Struck (with Injury)"|TYPE == "Vehicle Collision or Pedestrian Struck (with Fatality)")
Mon1
```


```{r}
Mon%>% 
  ggplot(aes(x = MONTH, y=n)) +
  geom_bar(stat = "identity", fill="gray", width=0.9) +
  geom_point(data = Mon1, aes(x=MONTH, y=n)) + 
  theme(axis.text.x = element_text(angle = 30, hjust=1))+
  scale_x_continuous(name = "Months ", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12)) +
  scale_y_continuous(name = "Number of Crimes " , breaks = c(5000,10000,15000,20000))

```

#### Describe preliminary observations and intuition about the research question

Based on a preliminary observation from the graph we find that some months have more crime in a reported area.


### TWO Data Sources

#### Primary Data

The primary data that we will use is from https://www.kaggle.com/ankkur13/boston-crime-data 

#### Other data sources

ZipGeography is an another data source that we are planning to use.


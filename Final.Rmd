---
title: "STAT 184 Final Project Preliminary EDA" 
author: "Abhishek Raj, Sarthak Batra and Parthiv Khaund"
output: html_notebook
---


## Final Project 


## Front Matter
```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(mosaic)
library(tidyverse)

```

#### Loading Data

```{r}
crime_stats <- read.csv("crime.csv")
Van_crime_stats <- read.csv("Vancouver_crime_data.csv")
```

#### Summary Statistics
```{r}
str(crime_stats)
```

```{r}
summary(crime_stats)
```


```{r}
crime_stats
```


### Data Wrangling

#### Data Cleaning

```{r}
df <- crime_stats
df <- df[, -c(13, 17)] 
df[1:10,]

```

```{r}
df1 <- Van_crime_stats
df1 <- df1[, c(1,3)] 
df1[1:10,]


```


#### Count of Offence Codes

```{r}
Test<-
  df%>%
  select(OFFENSE_CODE_GROUP)%>%
  count(OFFENSE_CODE_GROUP, sort = TRUE)%>%
  head(10)
Test
```

#### Number of offence in Month

```{r}
Month<-
  df%>%
  select(OFFENSE_CODE_GROUP,MONTH)%>%
  count(OFFENSE_CODE_GROUP, MONTH, sort = TRUE)%>%
  select(MONTH,n)
Month

BarTest <- aggregate(Month$n, by=list(MONTH=Month$MONTH), FUN=sum)
BarTest

```



```{r}
Mon<-
  df%>%
  select(OFFENSE_CODE_GROUP,MONTH)%>%
  count(OFFENSE_CODE_GROUP, MONTH, sort = TRUE)%>%
  filter(OFFENSE_CODE_GROUP == "Motor Vehicle Accident Response"|OFFENSE_CODE_GROUP == "Larceny"|OFFENSE_CODE_GROUP == "Medical Assistance"|OFFENSE_CODE_GROUP == "Investigate Person"|OFFENSE_CODE_GROUP == "Other"|OFFENSE_CODE_GROUP == "Drug Violation"|OFFENSE_CODE_GROUP == "Simple Assault"|OFFENSE_CODE_GROUP == "Vandalism"|OFFENSE_CODE_GROUP == "Verbal Disputes"|OFFENSE_CODE_GROUP == "Towed")
Mon



```






```{r}
ggplot(data=Mon,aes(x=MONTH,y=n ,fill=OFFENSE_CODE_GROUP))+geom_bar(stat='identity',position='stack', width=.9)+scale_fill_brewer(type='div',palette=1) + scale_x_continuous(name = "Months ", breaks = c(1,2,3,4,5,6,7,8,9,10,11,12)) + scale_y_continuous(name = "Number of Crimes " , breaks = c(5000,10000,15000,20000))

```

#### Trying Regex to find Auto Theft with description

```{r}
regex <- "MOTORCYCLE|SCOOTER|LEASED|RENTED VEHICLE"
Test1<-
  df%>%
  select(OFFENSE_CODE_GROUP,OFFENSE_DESCRIPTION)%>%
  filter(OFFENSE_CODE_GROUP == "Auto Theft")%>%
  filter(grepl(pattern = regex, OFFENSE_DESCRIPTION))
Test1

```

```{r}


```

#### Describe preliminary observations and intuition about the research question

Based on a preliminary observation from the graph we find that some months have more crime in a reported area.


### TWO Data Sources

#### Primary Data

The primary data that we will use is from https://www.kaggle.com/ankkur13/boston-crime-data 

#### Other data sources

ZipGeography is an another data source that we are planning to use.